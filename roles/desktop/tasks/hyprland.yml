---
- name: "Install Hyprland"
  pacman:
    name: "hyprland"
    state: "present"
  become: yes

- name: "Install Wayland utilities"
  pacman:
    name:
      - "qt5-wayland"
      - "qt6-wayland"
      - "wayland"
      - "wl-clipboard"
      - "gammastep"
      - "xdg-desktop-portal-hyprland"
    state: "present"
  become: yes

- name: "Install Hyprland utilities"
  pacman:
    name:
      - "hyprpaper"
      - "hypridle"
      - "hyprlock"
      - "waybar"
    state: "present"
  become: yes

- include_role:
    name: "yay"
  with_items:
    - "hyprshot"
    - "pywal-git"
  loop_control:
    loop_var: "pkg_name"

- name: "Create folder for Hyprland configuration and scripts"
  file:
    path: "{{ item }}"
    state: "directory"
    mode: "0700"
  with_items:
    - "{{ hyprland_directory }}"
    - "{{ hyprland_directory }}/scripts"
    - "{{ wal_directory }}"
    - "{{ wal_directory }}/templates"

- name: "Add Hyprland template for wal"
  template:
    src: "wal/colors-hyprland.conf.j2"
    dest: "{{ wal_directory }}/templates/colors-hyprland.conf"
    mode: "0600"

- name: "Set colors"
  command: "wal -i {{ wallpaper_directory }}/wallpaper.jpg -s -t"

- name: "Copy Hyprland configurations"
  template:
    src: "hyprland/{{ item }}.j2"
    dest: "{{ hyprland_directory }}/{{ item }}"
    mode: "0600"
  with_items:
    - "hyprland.conf"
    - "hyprpaper.conf"
    - "hypridle.conf"
    - "hyprlock.conf"

- name: "Copy Hyprland script"
  template:
    src: "hyprland/scripts/{{ item }}.j2"
    dest: "{{ hyprland_directory }}/scripts/{{ item }}"
    mode: "0700"
  with_items:
    - "special-launcher.sh"
    - "wlogout.sh"
