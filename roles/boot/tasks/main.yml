---
- name: "install intel-ucode"
  pacman:
    name: "intel-ucode"
    state: "present"
  become: yes

- name: "install systemd-boot"
  command: "bootctl --path={{ esp_mount }} install"
  become: yes

- name: "create folder for loader entries"
  file:
    path: "{{ esp_mount}}/loader/entries"
    state: "directory"
  become: yes

- name: "copy entry for arch"
  template:
    src: "arch.conf.j2"
    dest: "{{ esp_mount}}/loader/entries/arch.conf"
    mode: "0744"
  become: yes

- include_role:
    name: "pacaur"
    tasks_from: "install"
  vars:
    pkg_name: "systemd-boot-pacman-hook"
