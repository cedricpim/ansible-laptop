---
- name: install pacaur dependencies
  pacman:
    name: "{{ item }}"
    state: present
  with_items:
    - expac
    - yajl
    - sudo
    - git
  become: yes

- name: check if pacaur is installed
  command: "pacman -Q pacaur"
  failed_when: false
  changed_when: aur_pacaur_check.rc != 0
  register: aur_pacaur_check

- name: "create {{ user_name }} user"
  user:
    name: "{{ user_name }}"
    append: true
    groups: wheel
    state: present
  become: yes
  when: aur_pacaur_check|changed

- import_tasks: cower.yml
  when: aur_pacaur_check|changed

- import_tasks: pacaur.yml
  when: aur_pacaur_check|changed
