---
- name: "install pacaur dependencies"
  pacman:
    name: "{{ item }}"
    state: present
  with_items:
    - "expac"
    - "yajl"
    - "sudo"
    - "git"
  become: yes

- name: "check if pacaur is installed"
  command: "pacman -Q pacaur"
  register: aur_pacaur_check
  failed_when: false
  changed_when: false

- name: "ensure {{ user }} exists"
  user:
    name: "{{ user }}"
    append: true
    groups: "wheel"
    state: present
  become: yes
  when: aur_package_check is defined and aur_pacaur_check.rc != 0

- import_tasks: cower.yml
  when: aur_package_check is defined and aur_pacaur_check.rc != 0

- import_tasks: pacaur.yml
  when: aur_package_check is defined and aur_pacaur_check.rc != 0
