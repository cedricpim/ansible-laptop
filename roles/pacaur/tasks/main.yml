---
- name: "Install pacaur dependencies"
  pacman:
    name:
      - "expac"
      - "yajl"
      - "sudo"
      - "git"
    state: "present"
  become: yes

- name: "Check if pacaur is installed"
  command: "pacman -Q pacaur"
  register: aur_pacaur_check
  failed_when: false
  changed_when: false

- name: "Ensure {{ user }} exists"
  user:
    name: "{{ user }}"
    append: yes
    groups: "wheel"
    state: "present"
  become: yes
  when: aur_pacaur_check is defined and aur_pacaur_check.rc != 0

- import_tasks: cower.yml
  when: aur_pacaur_check is defined and aur_pacaur_check.rc != 0

- import_tasks: pacaur.yml
  when: aur_pacaur_check is defined and aur_pacaur_check.rc != 0
