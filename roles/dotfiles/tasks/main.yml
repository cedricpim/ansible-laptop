---
- name: install git
  pacman:
    name: git
    state: present

- name: ensure dotfiles is cloned and up-to-date
  git:
    repo: "{{ dotfiles_repo }}"
    dest: "{{ dotfiles_dest }}"
    clone: yes
    update: yes
  become_user: "{{ user_name }}"

- include_tasks: symlink.yml
  vars:
    src: "{{ scripts_directory }}"
    create_directory: yes

- include_tasks: symlink.yml
  vars:
    src: "{{ git_directory }}"
    create_directory: no

- name: "copy git-details configuration to {{ git_details }}"
  template:
    src: "git-details.j2"
    dest: "{{ git_details }}"
    mode: 0600
  become_user: "{{ user_name }}"
