---
- name: install git
  pacman:
    name: git
    state: present
  become: yes

- name: ensure dotfiles is cloned and up-to-date
  git:
    repo: "{{ dotfiles_repo }}"
    dest: "{{ dotfiles_dest }}"
    clone: yes
    update: yes

- name: create folder for scripts
  file:
    path: "{{ scripts_directory }}"
    state: directory

- name: copy scripts files
  template:
    src: "{{ item }}"
    dest: "{{ scripts_directory }}/{{ item | basename | regex_replace('.j2$','') }}"
    mode: 0700
  with_fileglob: ../templates/scripts/*.j2

- name: copy git files
  template:
    src: "{{ item }}"
    dest: "~/.{{ item | basename | regex_replace('.j2$','') }}"
    mode: 0600
  with_fileglob: ../templates/git/*.j2
