{{ ansible_managed | comment }}

# Credits to Miha Rekar: http://mr.si/posts/2016/01/29/dont-screw-up-when-you-ssh-to-production/

if [[ "$TERM" == "xterm-termite" ]]; then
  function change-color() {
    printf "\033]10;$1\007" # foreground
    printf "\033]11;$2\007" # background
  }

  function original-color() {
    grep -m 1 $1 ~/.config/termite/config | sed -r 's/[^#]*(.+)/\1/'
  }

  function reset-colors() {
    change-color "$(original-color 'foreground')" "$(original-color 'background')"
  }

  function colorssh() {
    if [[ "$1" =~ "^k8prod" ]] || [[ "$1" =~ "^cx ssh " ]] || [[ "$1" =~ "^ssh " ]]; then
      change-color "#FFFFFF" "#CB7E7E"
    else
      reset-colors
    fi
  }

  autoload -U add-zsh-hook
  add-zsh-hook precmd  reset-colors
  add-zsh-hook preexec colorssh
fi
