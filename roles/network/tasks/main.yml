---
- name: "Install network tools"
  pacman:
    name:
      - "iw"
      - "iwd"
      - "bluez"
      - "connman"
      - "cmst"
      - "ntp"
      - "openresolv"
      - "wpa_supplicant"
    state: "present"
  become: yes

- name: "Copy resolvconf configuration"
  template:
    src: "resolvconf/resolvconf.conf.j2"
    dest: "/etc/resolvconf.conf"
    mode: "0644"
  become: yes
  notify: "Rebuild resolvconf configuration"

- name: "Create folder for systemd ConnMan"
  file:
    path: "{{ systemd_directory }}/connman.service.d"
    state: "directory"
    mode: "0755"
  become: yes

- name: "Enable/start service for ConnMan"
  systemd:
    name: "connman"
    state: "started"
    enabled: yes
    daemon_reload: yes
  become: yes

- name: "Enable/start service for NTP"
  systemd:
    name: "ntpd"
    state: "started"
    enabled: yes
  become: yes

- import_tasks: "mullvad.yml"
