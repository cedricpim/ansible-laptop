---
- name: "install network tools"
  pacman:
    name: "{{ item }}"
    state: present
  with_items:
    - "iw"
    - "wpa_supplicant"
    - "networkmanager"
    - "ntp"
  become: yes

- name: "start service for NTP"
  systemd:
    name: "ntpd"
    state: started
    enabled: yes
  become: yes

- name: "connect to WI-FI"
  block:
    - command: "ip link set {{ network_interface }} up"
    - command: "wpa_supplicant -B -i {{ network_interface }} -C <(wpa_passphrase {{ network_name }} {{ network_passphrase }})"
    - command: "dhcpcd {{ network_interface }}"
  become: yes
  when:
    - network_interface is defined
    - network_name is defined
    - network_passphrase is defined
