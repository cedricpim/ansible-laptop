---
- name: install Budgie
  pacman:
    name: "{{ item }}"
    state: present
  with_items:
    - budgie-desktop
    - gnome
    - seahorse
    - gnome-tweak-tool
    - gnome-keyring

- name: enable GDM
  systemd:
    name: gdm
    enabled: yes

- name: get mouse scroll settings
  command: "gsettings get org.gnome.desktop.peripherals.touchpad natural-scroll"
  become_user: "{{ user_name }}"
  changed_when: false
  register: mouse_scroll_settings

- name: get mouse click settings
  command: "gsettings get org.gnome.desktop.peripherals.touchpad click-method"
  become_user: "{{ user_name }}"
  changed_when: false
  register: mouse_click_settings

- name: define mouse scroll settings
  command: "dbus-launch gsettings set org.gnome.desktop.peripherals.touchpad natural-scroll false"
  become_user: "{{ user_name }}"
  when: mouse_scroll_settings.stdout|bool

- name: define mouse click settings
  command: "dbus-launch gsettings set org.gnome.desktop.peripherals.touchpad click-method 'fingers'"
  become_user: "{{ user_name }}"
  when: mouse_click_settings.stdout != "'fingers'"
