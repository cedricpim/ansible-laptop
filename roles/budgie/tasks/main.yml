---
- name: "install Budgie"
  pacman:
    name: "{{ item }}"
    state: present
  with_items:
    - "budgie-desktop"
    - "gnome"
    - "seahorse"
    - "gnome-tweak-tool"
    - "gnome-keyring"
    - "ntfs-3g"
  become: yes

- name: "enable GDM"
  systemd:
    name: "gdm"
    enabled: yes
  become: yes

- name: "copy startx configuration file"
  template:
    src: "xprofile.j2"
    dest: "~/.xprofile"
    mode: 0600

- name: "create folder for autostart programs"
  file:
    path: "{{ autostart_dir }}"
    state: directory

- name: "copy xprofile to autostart"
  template:
    src: "xprofile.desktop.j2"
    dest: "{{ autostart_dir }}/xprofile.desktop"
    mode: 0644

- name: "install python-psutil for dconf"
  pacman:
    name: "python-psutil"
    state: present
  become: yes

- name: "set mouse settings"
  dconf:
    key: "{{ touchpad_dconf_base_key }}/{{ item.key }}"
    value: "{{ item.value }}"
    state: present
  with_items:
    - { key: "natural-scroll", value: "{{ touchpad_natural_scroll }}" }
    - { key: "click-method", value: "{{ touchpad_click_method }}" }
