---
- include_role:
    name: "pacaur"
    tasks_from: "install"
  vars:
    pkg_name: "todotxt"

- name: "create folders for todo configuration and files"
  file:
    path: "{{ item }}"
    state: "directory"
  with_items:
    - "{{ todo_main_directory }}"
    - "{{ todo_directory }}"

- name: "copy todo configuration"
  template:
    src: "config.j2"
    dest: "{{ todo_directory }}/config"
    mode: "0600"

- name: "download todo.actions.d repository"
  block:
    - file: path="{{ todo_actions_dest }}" state="directory"
    - git: repo="{{ todo_actions_repo }}" dest="{{ todo_actions_dest }}" clone=yes update=yes
    - replace: path="{{ todo_actions_dest }}/.git/config" regexp="{{ gist_github_https_base }}" replace="{{ gist_github_ssh_base }}"
