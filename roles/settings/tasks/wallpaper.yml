---
- name: "create {{ wallpaper_directory }}"
  file:
    path: "{{ wallpaper_directory }}"
    state: "directory"

- name: "copy wallpaper to {{ wallpaper_directory }}"
  copy:
    src: "{{ wallpaper }}"
    dest: "{{ wallpaper_directory }}/wallpaper{{ wallpaper | splitext | last }}"
    mode: 0600

- name: "set wallpaper as background image"
  dconf:
    key: "{{ dconf_background_key }}"
    value: "'file://{{ wallpaper_directory | regex_replace('~', ansible_env.HOME) }}/wallpaper{{ wallpaper | splitext | last }}'"
    state: "present"
